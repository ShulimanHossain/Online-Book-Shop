{% extends "base.html" %}
{% block content %}

<!-- Custom CSS for Home Page -->
<style>
/* Container and dashboard title */
.member-dashboard {
    min-height: 100vh;
    padding: 2rem;
    background: linear-gradient(to bottom right, #f5f3ff, #ede9fe, #fce7f3);
    font-family: 'Inter', sans-serif;
}
.dashboard-title {
    text-align: center;
    font-size: 2.5rem;
    font-weight: 800;
    background: linear-gradient(90deg, #ffffff, #6366f1);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 2rem;
}
body {
    background: url("{{ url_for('static', filename='images/two.jpg') }}") no-repeat center center fixed;
    background-size: cover;
    font-family: 'Segoe UI', Arial, sans-serif;
}
.member-dashboard {
        background: url("{{ url_for('static', filename='images/two.jpg') }}") no-repeat center center fixed;
        background-size: cover;
        font-family: 'Segoe UI', Arial, sans-serif;
    }
/* Book Cards */
.book-card, .card-body .p-3 {
    background: rgba(255,255,255,0.7);
    backdrop-filter: blur(6px);
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.book-card:hover, .card-body .p-3:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
}

/* Book Text */
.fw-semibold {
    font-weight: 700;
    color: #5b21b6;
}
.text-muted {
    color: #6b7280 !important;
}
.mt-2 {
    margin-top: 0.5rem !important;
}

/* Top Authors */
.list-group-item {
    border-radius: 8px;
    transition: background 0.3s ease;
}
.list-group-item:hover {
    background: rgba(147, 51, 234, 0.1);
}

/* Animate Price */
.book-price {
    font-weight: 700;
    color: #16a34a;
    font-size: 1.1rem;
    transition: transform 0.3s ease, color 0.3s ease;
}
/*.animated-price {
    animation: pricePulse 1.2s infinite alternate;
}*/
@keyframes pricePulse {
    0% { color: #16a34a; transform: scale(1); }
    50% { color: #22c55e; transform: scale(1.1); }
    100% { color: #16a34a; transform: scale(1); }
}
</style>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="dashboard-title">Top Selling & Authors</h1>
    <form method="post" class="m-0">
        <input type="hidden" name="allbook" value="allbook">
        <button class="btn btn-secondary btn-sm" 
                style="background: linear-gradient(90deg, #8b5cf6, #6366f1); color: white; border: none;">
            Show All Books
        </button>
    </form>
</div>


<div class="row g-4">
    <!-- Top Selling Books -->
    <div class="col-lg-8">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-white">
                <h2 class="h5 m-0">Top Selling Books</h2>
            </div>
            <div class="card-body">
                {% if topselling %}
                <div class="row row-cols-1 row-cols-md-2 g-3">
                    {% for b in topselling %}
                    <div class="col">
                        <div class="p-3 border rounded-3 h-100 book-card">
                            <div class="fw-semibold">{{ b.title }}</div>
                            {% if b.author_name %}<div class="text-muted small">by {{ b.author_name }}</div>{% endif %}
                            {% if b.price %}<div class="mt-2 book-price animated-price">৳ {{ '%.2f'|format(b.price) }}</div>{% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                    <p class="text-muted">No data found.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Top Authors -->
    <div class="col-lg-4">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-white">
                <h2 class="h5 m-0">Top Authors</h2>
            </div>
            <div class="card-body">
                {% if topauthors %}
                <ul class="list-group list-group-flush">
                    {% for a in topauthors %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ a.name or a.author_name }}</span>
                        {% if a.rating %}<span class="badge bg-warning text-dark">★ {{ a.rating }}</span>{% endif %}
                    </li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted">No data found.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Upcoming Books -->
{% if upcoming_books %}
<hr class="my-4">
<h2 class="h5">Upcoming Books</h2>
<div class="row row-cols-1 row-cols-md-3 g-3">
    {% for b in upcoming_books %}
    <div class="col">
        <div class="card h-100 shadow-sm book-card">
            <div class="card-body">
                <div class="fw-semibold">{{ b.title }}</div>
                <div class="text-muted small">{{ b.author_name if b.author_name else '' }}</div>
                <div class="mt-2 text-sm text-blue-500">
                    Release Date: {{ b.release_date.strftime('%d %b, %Y') if b.release_date else 'TBA' }}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<p class="text-muted mt-3">No upcoming books at the moment.</p>
{% endif %}


<!-- All Books -->
{% if allbook %}
<hr class="my-4">
<h2 class="h5">All Books</h2>
<div class="row row-cols-1 row-cols-md-3 g-3">
    {% for b in allbook %}
    <div class="col">
        <div class="card h-100 shadow-sm book-card">
            <div class="card-body">
                <div class="fw-semibold">{{ b.title }}</div>
                <div class="text-muted small">{{ b.author_name if b.author_name else '' }}</div>
                <div class="mt-2 book-price animated-price">৳ {{ '%.2f'|format(b.price) if b.price is not none else 'N/A' }}</div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

{% endblock %}