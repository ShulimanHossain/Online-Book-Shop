{% extends "base.html" %}
{% block content %}

<!-- Fullscreen background layer (covers entire viewport) -->
<div class="bg-fullscreen" aria-hidden="true"></div>

<div class="member-dashboard">

  <h1 class="dashboard-title animate-bounce">Member Dashboard</h1>

  <!-- User Info -->
  {% if user_info %}
  <div class="user-info-card animate-fadeIn">
    <h2>Your Information</h2>
    <p><strong>Username:</strong> {{ user_info.username }}</p>
    <p><strong>Email:</strong> {{ user_info.email }}</p>
    <p><strong>Contact:</strong> {{ user_info.phone_number }}</p>
    <p><strong>Total Books Purchased:</strong> {{ user_info.total_books }}</p>
  </div>
  {% endif %}

  <!-- User Orders -->
  {% if order_info %}
  <div class="order-info-card animate-fadeIn">
    <h2>Your Orders</h2>
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Total Bill</th>
            <th>Order Date</th>
          </tr>
        </thead>
        <tbody>
          {% for o in order_info %}
          <tr>
            <td>{{ o.order_id }}</td>
            <td>৳ <span class="animated-price">{{ '%.2f'|format(o.total_bill) }}</span></td>
            <td>{{ o.order_date.strftime('%Y-%m-%d') }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

  <!-- Books List -->
  <div class="books-grid">
    {% for b in books %}
    <div class="book-frame animate-fadeIn">
      <div class="book-title">{{ b.title }}</div>
      {% if b.author_name %}
      <div class="book-author">by {{ b.author_name }}</div>
      {% endif %}
      <div class="book-footer">
        <span class="book-price animated-price">৳ {{ '%.2f'|format(b.price) }}</span>
        <form method="post" action="{{ url_for('addCart', book_id=b.book_id) }}" class="cart-form">
          <input type="number" min="1" value="1" name="quantity" class="quantity-input">
          <button class="add-btn">Add</button>
        </form>
      </div>
      <div class="book-links">
        <a href="{{ url_for('review', book_id=b.book_id) }}">Review this book</a>
        <a href="{{ url_for('book_reviews', book_id=b.book_id) }}">View all reviews</a>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- Embedded CSS -->
<style>
/* ===== Fullscreen background (same image as login) ===== */
.bg-fullscreen{
  position: fixed;
  inset: 0;
  background: url("{{ url_for('static', filename='images/two.jpg') }}") center / cover no-repeat;
  z-index: 0;             /* sit under page content */
  pointer-events: none;   /* don't block clicks */
}

/* ===== Page container ===== */
.member-dashboard {
    position: relative;
    z-index: 1;                 /* above the bg layer */
    min-height: 100dvh;
    padding: 2rem;
    background: transparent;    /* let the image show through */
    font-family: 'Inter', sans-serif;
}

/* Title */
.dashboard-title {
    text-align: center;
    font-size: 2.5rem;
    font-weight: 800;
    background: linear-gradient(90deg, #8b5cf6, #6366f1);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 2rem;
}

/* Info & Orders cards (glass) */
.user-info-card, .order-info-card {
    max-width: 900px;
    margin: 1rem auto;
    background: rgba(255, 255, 255, 0.65);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    padding: 1.5rem;
    border-radius: 1rem;
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    transition: transform 0.4s ease, box-shadow 0.4s ease;
}
.user-info-card:hover, .order-info-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.18);
}

/* Table */
.table-wrapper { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; background: transparent; }
thead {
    background: linear-gradient(to right, #8b5cf6, #6366f1);
    color: white;
}
th, td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #e5e7eb; }
tbody tr:hover { background: rgba(147, 51, 234, 0.08); transition: background 0.3s ease; }

/* Books Grid */
.books-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
}

/* Book card (glass) */
.book-frame {
    background: rgba(255, 255, 255, 0.65);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    border-radius: 1rem;
    padding: 1rem;
    display: flex; flex-direction: column; justify-content: space-between;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    transition: transform 0.4s ease, box-shadow 0.4s ease, border 0.4s ease;
}
.book-frame:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.22);
    border: 2px solid #8b5cf6;
}

/* Book text */
.book-title { font-weight: 700; color: #4c1d95; font-size: 1.2rem; }
.book-author { color: #6b7280; margin-bottom: 1rem; }
.book-footer { display: flex; justify-content: space-between; align-items: center; }
.book-price { font-weight: 700; color: #16a34a; font-size: 1.1rem; transition: transform .3s, color .3s; }

/* Price animation */
.animated-price { animation: pricePulse 1.2s infinite alternate; }
@keyframes pricePulse {
  0% { color: #16a34a; transform: scale(1); }
  50% { color: #22c55e; transform: scale(1.1); }
  100% { color: #16a34a; transform: scale(1); }
}

/* Cart form */
.cart-form { display: flex; gap: 0.5rem; }
.quantity-input {
    width: 56px; padding: 0.35rem 0.55rem; border-radius: 0.375rem;
    border: 1px solid #d1d5db; text-align: center; transition: border .3s, box-shadow .3s;
}
.quantity-input:focus { border-color: #8b5cf6; box-shadow: 0 0 0 3px rgba(139,92,246,0.3); outline: none; }
.add-btn {
    background: linear-gradient(90deg, #8b5cf6, #6366f1);
    color: #fff; padding: 0.45rem 0.9rem; border-radius: 0.5rem; font-weight: 600;
    transition: transform .3s, box-shadow .3s;
}
.add-btn:hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(99,102,241,0.4); }

/* Book links */
.book-links { display: flex; flex-direction: column; gap: 0.35rem; margin-top: 0.8rem; }
.book-links a { color: #6366f1; font-weight: 500; transition: color .3s, transform .3s; }
.book-links a:hover { color: #8b5cf6; transform: translateX(4px); }

/* Animations */
@keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
/* .animate-bounce { animation: bounce 1s infinite; } */
@keyframes fadeIn { 0%{opacity:0; transform:translateY(20px)} 100%{opacity:1; transform:translateY(0)} }
.animate-fadeIn { animation: fadeIn .7s ease forwards; }
</style>
{% endblock %}
